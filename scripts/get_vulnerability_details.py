#!/usr/bin/env python3
"""
Get detailed vulnerability information
"""

import asyncio
import httpx
import json

DASHBOARD_URL = "http://localhost:8000"


async def get_vulnerability_details():
    """Get all vulnerabilities with details"""
    try:
        async with httpx.AsyncClient(timeout=10.0) as client:
            response = await client.get(f"{DASHBOARD_URL}/api/vulnerabilities")
            if response.status_code == 200:
                data = response.json()
                vulns = data.get('vulnerabilities', [])
                
                print("ğŸš¨ Vulnerability Details")
                print("=" * 80)
                print()
                
                if not vulns:
                    print("â„¹ï¸  No vulnerabilities found yet")
                    return
                
                for i, vuln in enumerate(vulns, 1):
                    title = vuln.get('title', 'Unknown')
                    severity = vuln.get('severity', 'unknown')
                    description = vuln.get('description', 'N/A')
                    url = vuln.get('url', 'N/A')
                    vuln_type = vuln.get('vulnerability_type', 'N/A')
                    exploitability = vuln.get('exploitability', 'N/A')
                    profit_potential = vuln.get('profit_potential', 'N/A')
                    
                    severity_icon = {
                        'critical': 'ğŸ”´',
                        'high': 'ğŸŸ ',
                        'medium': 'ğŸŸ¡',
                        'low': 'ğŸŸ¢',
                        'info': 'â„¹ï¸'
                    }.get(severity, 'â“')
                    
                    print(f"{severity_icon} [{i}] {title}")
                    print(f"   Severity: {severity.upper()}")
                    print(f"   Type: {vuln_type}")
                    print(f"   URL: {url}")
                    print(f"   Exploitability: {exploitability}")
                    print(f"   Profit Potential: {profit_potential}")
                    print(f"   Description: {description}")
                    print()
                
                print("=" * 80)
                print(f"Total: {len(vulns)} vulnerabilities found")
                
    except Exception as e:
        print(f"Error: {e}")
        import traceback
        traceback.print_exc()


if __name__ == "__main__":
    asyncio.run(get_vulnerability_details())

